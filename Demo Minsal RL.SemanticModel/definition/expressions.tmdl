expression 'Errores en Portfolio' =
		let
		Origen = Portfolio,
		  #"Errores de coincidencia detectados" = let
		    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Origen, Table.ColumnsOfType(Origen, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),
		    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),
		    fieldNames = Record.FieldNames(recordTypeFields),
		    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),
		    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = "El tipo del valor no coincide con el tipo de la columna.", Detail = v], fieldTypes{i}})
		in
		    Table.TransformColumns(Origen, pairs),
		  #"Índice agregado" = Table.AddIndexColumn(#"Errores de coincidencia detectados", "Número de fila" ,1),
		  #"Conservar errores" = Table.SelectRowsWithErrors(#"Índice agregado", {"map", "Proyecto", "Tipo Ficha", "Jefe Proyecto", "Tiempo actualización", "Código BIP", "Región N°", "Servicio Salud", "Comuna", "Comuna de Influencia", "Tipo", "Cartera", "Complejidad", "Tipo CESFAM", "Estado", "Subestado", "Estatus mes actual", "Modalidad contratación", "Fase diseño-ejecución", "Poblacion beneficiaria", "Superficie (m2)", "N° de camas actuales", "N° de camas proyectado", "N° de pabellones", "N° camas básicas", "N° camas críticas", "N° camas agudas", "N° camas salud mental", "N° salas parto integral", "Otras Camas", "N° box total", "N° box médicos", "N° box no médicos", "N° box dental", "N° salas de procedimiento", "N° sillones diálisis", "N° sillones QT", "Rate vigente", "Convenio programación", "Financ. etapa actual", "Monto Ficha IDI M$", "Programa gobierno", "Detalle del mes", "Nudos Críticos", "Acciones Correctivas", "%Avance real", "%Avance plan", "Desviación", "Fecha última actualización", "Usuario última actualización", "Empresa encargada estudio", "Fecha inicio estudio", "Fecha término estimada estudio", "Superficie PMA (M2)", "Coordinador proyecto estudios", "Información interna estudios", "Empresa encargada diseño", "Fecha inicio diseño", "Fecha término estimada diseño", "Fecha RS diseño", "Superficie diseño (m2)", "Información interna diseño", "Id licitación", "Bases de licitación", "Fecha publicación", "Fecha apertura técnica", "Fecha adjudicación portal", "Presupuesto estimado ($)", "Empresas oferentes", "Empresa adjudicada", "Fecha aprobación contrato", "Fecha entrega terreno", "RUT Constructora", "Coordinador licitación", "Nombre ITO", "Monitor MINSAL", "Empresa constructora", "Historial licitación", "Fecha inicio obra", "Fecha término obras", "Plazo ejecución (días)", "Aumento de plazo (días)", "Fecha término actualizada (con aumento plazo)", "Trimestre término estimado", "Trimestre recepción provisoria sin obs estimado", "Fecha recepción provisoria sin Obs.", "Proyecto con termino anticipado", "Fecha termino anticipado", "Trimestre inicio operación estimado", "Fecha recepción municipal", "Fecha Autorización Sanitaria", "Presupuesto Oficial UF (sólo APP)", "Valor Contrato Inicial $ (Neto+IVA)", "Valor proforma ($)", "Presupuesto de obra ($)", "Modificaciones aprobadas ($)", "Mayores gastos generales ($)", "Valor Contrato Actualizado ($)", "% Modificaciones respecto valor contratado", "Información interna ejecución", "Fecha solicitud reevaluación", "Motivo de la reevaluacion", "Item a reevaluar", "Monto a reevaluar", "Monto total final reevaluacion", "Detalle reevaluacion", "Trimestre estimado fin reevaluación", "Fecha nuevo RS tras reevaluación", "Modalidad transferencia terreno", "Estado terreno", "Detalle terreno", "Finalización programada del traspaso", "Fecha fin traspaso a MBN", "Superficie terreno (m2)", "N° ROL (SII)", "Dirección (calle, N°, lote, otro)", "Coordinador APP", "Referente SS anteproyecto arq.", "Estado anteproyecto", "% Avance estimado anteproyecto", "Detalle avance anteproyecto (fecha.detalle)", "Fecha inicio partido general", "Fecha inicio anteproyecto", "Fecha fin anteproyecto", "Empresa encargada anteproyecto", "Cargar archivo", "Último nivel", "Registrar riesgo", "Id interno", "Finalizacion programada anteproyecto", "Historial del TAC", "Dirección"}),
		  #"Columnas reordenadas" = Table.ReorderColumns(#"Conservar errores", {"Número de fila", "map", "Proyecto", "Tipo Ficha", "Jefe Proyecto", "Tiempo actualización", "Código BIP", "Región N°", "Servicio Salud", "Comuna", "Comuna de Influencia", "Tipo", "Cartera", "Complejidad", "Tipo CESFAM", "Estado", "Subestado", "Estatus mes actual", "Modalidad contratación", "Fase diseño-ejecución", "Poblacion beneficiaria", "Superficie (m2)", "N° de camas actuales", "N° de camas proyectado", "N° de pabellones", "N° camas básicas", "N° camas críticas", "N° camas agudas", "N° camas salud mental", "N° salas parto integral", "Otras Camas", "N° box total", "N° box médicos", "N° box no médicos", "N° box dental", "N° salas de procedimiento", "N° sillones diálisis", "N° sillones QT", "Rate vigente", "Convenio programación", "Financ. etapa actual", "Monto Ficha IDI M$", "Programa gobierno", "Detalle del mes", "Nudos Críticos", "Acciones Correctivas", "%Avance real", "%Avance plan", "Desviación", "Fecha última actualización", "Usuario última actualización", "Empresa encargada estudio", "Fecha inicio estudio", "Fecha término estimada estudio", "Superficie PMA (M2)", "Coordinador proyecto estudios", "Información interna estudios", "Empresa encargada diseño", "Fecha inicio diseño", "Fecha término estimada diseño", "Fecha RS diseño", "Superficie diseño (m2)", "Información interna diseño", "Id licitación", "Bases de licitación", "Fecha publicación", "Fecha apertura técnica", "Fecha adjudicación portal", "Presupuesto estimado ($)", "Empresas oferentes", "Empresa adjudicada", "Fecha aprobación contrato", "Fecha entrega terreno", "RUT Constructora", "Coordinador licitación", "Nombre ITO", "Monitor MINSAL", "Empresa constructora", "Historial licitación", "Fecha inicio obra", "Fecha término obras", "Plazo ejecución (días)", "Aumento de plazo (días)", "Fecha término actualizada (con aumento plazo)", "Trimestre término estimado", "Trimestre recepción provisoria sin obs estimado", "Fecha recepción provisoria sin Obs.", "Proyecto con termino anticipado", "Fecha termino anticipado", "Trimestre inicio operación estimado", "Fecha recepción municipal", "Fecha Autorización Sanitaria", "Presupuesto Oficial UF (sólo APP)", "Valor Contrato Inicial $ (Neto+IVA)", "Valor proforma ($)", "Presupuesto de obra ($)", "Modificaciones aprobadas ($)", "Mayores gastos generales ($)", "Valor Contrato Actualizado ($)", "% Modificaciones respecto valor contratado", "Información interna ejecución", "Fecha solicitud reevaluación", "Motivo de la reevaluacion", "Item a reevaluar", "Monto a reevaluar", "Monto total final reevaluacion", "Detalle reevaluacion", "Trimestre estimado fin reevaluación", "Fecha nuevo RS tras reevaluación", "Modalidad transferencia terreno", "Estado terreno", "Detalle terreno", "Finalización programada del traspaso", "Fecha fin traspaso a MBN", "Superficie terreno (m2)", "N° ROL (SII)", "Dirección (calle, N°, lote, otro)", "Coordinador APP", "Referente SS anteproyecto arq.", "Estado anteproyecto", "% Avance estimado anteproyecto", "Detalle avance anteproyecto (fecha.detalle)", "Fecha inicio partido general", "Fecha inicio anteproyecto", "Fecha fin anteproyecto", "Empresa encargada anteproyecto", "Cargar archivo", "Último nivel", "Registrar riesgo", "Id interno", "Finalizacion programada anteproyecto", "Historial del TAC", "Dirección"})
		in
		  #"Columnas reordenadas"
	lineageTag: ba0c69e7-8b70-4868-aaf2-2019a6d85f62
	queryGroup: 'Errores en las consultas: 09-08-2024 15:49:27'

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

